<tool id="isatab" name="ISA TAB Importer" version="0.1.0">

	<description>Import ISA TAB data format from public and private MetaboLights studies</description>

	<!--~~~~~~~
	~ COMMAND ~
	~~~~~~~~-->

	<command><![CDATA[
		## @@@BEGIN_CHEETAH@@@
		$__tool_directory__/mtbls-dwnld -t "$token" $study
		## @@@END_CHEETAH@@@
	]]></command>

	<!--~~~~~~
	~ INPUTS ~
	~~~~~~~-->

	<inputs>
		<param name="study" type="text" label="Study path at MetaboLights FTP Server" help="This should be obtained from the MetaboLights website." />
		<param optional="true" format="txt" name="token" type="text" label="Token or password"  help=""/>
	</inputs>

    <outputs>

        <data format="html" name="html_file" label="" />
	<data name="ISA_zip" format="zip" label="ISA Zip file"/>
	<data name="MAF_zip" format="zip" label="MAF Zip file"/>
	<data name="RAW_data" format="tar" label="RAW Data tar file"/>
          <collection type="list" label="A Files" name="a_files">
		<discover_datasets pattern="(?P&lt;designation&gt;a_.+)\.txt" directory="study_dir" format="tabular"/>
	  </collection>
	<collection type="list" label="S Files" name="s_files">
		<discover_datasets pattern="(?P&lt;designation&gt;s_.+)\.txt" format="tabular"/>
	</collection>
	<collection type="list" label="MAF Files" name="maf_files">
		<discover_datasets pattern="(?P&lt;designation&gt;m_.+)\.t.+" format="tabular"/>
	</collection>
	<data name="i_file" format="tabular" label="I File" from_work_dir="i_Investigation.txt" visible="true"/>
    </outputs>
    <tests>
        <test>
            <param name="name_of_study" value="test" />
            <param name="inputzip" value="metabolomics_study.zip" />
            <output name="output" value="metabolomics_study/test/index.html" />
        </test>
    </tests>
    <help><![CDATA[
**Overview**
 A program to download complete MetaboLights studies. 
    ]]></help>
    <citations>
        <citation type="doi">10.1002/0471250953.bi1413s53</citation>
        <citation type="doi">10.1007/s11306-015-0879-3</citation>
        <citation type="doi">10.1038/ng.1054</citation>
    </citations>
</tool>
